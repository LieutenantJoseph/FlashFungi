// Flash Fungi - Training Modules Component
// Structured learning modules for building foundational knowledge

window.TrainingModules = function TrainingModules({ onBack, onModuleSelect, userProgress, user }) {
    const [selectedCategory, setSelectedCategory] = React.useState('foundation');
    
    window.h = window.h || React.createElement; const h = window.h;
    
    // Foundation modules data
    const foundationModules = [
        {
            id: 'foundation-1',
            title: 'Basic Diagnostic Features',
            description: 'Learn to identify key mushroom parts: cap, stem, gills, and spores',
            duration: '20 min',
            difficulty: 'Beginner',
            icon: 'ðŸ”',
            completed: userProgress['foundation-1']?.completed || false
        },
        {
            id: 'foundation-2',
            title: 'Spore Print Basics',
            description: 'Master the essential skill of collecting and interpreting spore prints',
            duration: '15 min',
            difficulty: 'Beginner',
            icon: 'ðŸŽ¨',
            completed: userProgress['foundation-2']?.completed || false
        },
        {
            id: 'foundation-3',
            title: 'Safety First: Deadly Species',
            description: 'Critical knowledge about poisonous mushrooms in Arizona',
            duration: '25 min',
            difficulty: 'Beginner',
            icon: 'âš ï¸',
            completed: userProgress['foundation-3']?.completed || false
        },
        {
            id: 'foundation-4',
            title: 'Mycological Terminology',
            description: 'Essential vocabulary for accurate mushroom identification',
            duration: '18 min',
            difficulty: 'Beginner',
            icon: 'ðŸ“š',
            completed: userProgress['foundation-4']?.completed || false
        },
        {
            id: 'foundation-5',
            title: 'Arizona Fungal Families',
            description: 'Overview of major mushroom families found in Arizona',
            duration: '22 min',
            difficulty: 'Beginner',
            icon: 'ðŸŒµ',
            completed: userProgress['foundation-5']?.completed || false
        }
    ];

    const handleStartModule = (module) => {
        onModuleSelect(module);
    };

    return h('div', { style: { minHeight: '100vh', backgroundColor: '#f9fafb' } },
        // Header
        h('div', { style: { backgroundColor: 'white', borderBottom: '1px solid #e5e7eb', padding: '1rem' } },
            h('div', { style: { maxWidth: '72rem', margin: '0 auto' } },
                h('div', { style: { display: 'flex', alignItems: 'center', gap: '1rem' } },
                    h('button', { 
                        onClick: onBack, 
                        style: { background: 'none', border: 'none', cursor: 'pointer', fontSize: '1rem' } 
                    }, 'â† Back'),
                    h('div', null,
                        h('h1', { style: { fontSize: '1.5rem', fontWeight: 'bold' } }, 'ðŸŽ“ Training Modules'),
                        h('p', { style: { fontSize: '0.875rem', color: '#6b7280' } },
                            'Build your foundation with structured lessons'
                        )
                    )
                )
            )
        ),

        // Main Content
        h('div', { style: { maxWidth: '72rem', margin: '0 auto', padding: '2rem' } },
            // Progress overview
            h('div', {
                style: {
                    background: 'linear-gradient(to right, #10b981, #059669)',
                    borderRadius: '0.75rem',
                    color: 'white',
                    padding: '1.5rem',
                    marginBottom: '2rem'
                }
            },
                h('h2', { style: { fontSize: '1.25rem', fontWeight: 'bold', marginBottom: '0.5rem' } }, 
                    'Your Learning Progress'
                ),
                h('p', { style: { marginBottom: '1rem', opacity: 0.9 } }, 
                    `Welcome, ${user?.display_name || user?.username || 'Learner'}! Complete foundation modules to unlock advanced features.`
                ),
                h('div', { style: { display: 'flex', gap: '1rem' } },
                    h('div', { style: { backgroundColor: 'rgba(255,255,255,0.2)', padding: '0.5rem 1rem', borderRadius: '0.5rem' } },
                        `ðŸ“Š ${foundationModules.filter(m => m.completed).length}/5 Complete`
                    ),
                    h('div', { style: { backgroundColor: 'rgba(255,255,255,0.2)', padding: '0.5rem 1rem', borderRadius: '0.5rem' } },
                        `â±ï¸ ~90 min total`
                    )
                )
            ),

            // Foundation Modules Grid
            h('div', null,
                h('h3', { style: { fontSize: '1.25rem', fontWeight: 'bold', marginBottom: '1rem' } }, 
                    'ðŸ—¿ Foundation Modules'
                ),
                h('p', { style: { color: '#6b7280', marginBottom: '1.5rem' } }, 
                    'Essential knowledge for safe and accurate mushroom identification'
                ),
                
                h('div', { style: { display: 'grid', gridTemplateColumns: 'repeat(auto-fill, minmax(320px, 1fr))', gap: '1.5rem' } },
                    foundationModules.map((module, idx) =>
                        h('div', {
                            key: module.id,
                            style: {
                                backgroundColor: 'white',
                                borderRadius: '0.75rem',
                                padding: '1.5rem',
                                boxShadow: '0 1px 3px 0 rgba(0, 0, 0, 0.1)',
                                border: '2px solid transparent',
                                cursor: 'pointer',
                                transition: 'all 0.2s',
                                position: 'relative'
                            },
                            onClick: () => handleStartModule(module),
                            onMouseEnter: (e) => e.currentTarget.style.borderColor = '#10b981',
                            onMouseLeave: (e) => e.currentTarget.style.borderColor = 'transparent'
                        },
                            // Completion indicator
                            module.completed && h('div', {
                                style: {
                                    position: 'absolute',
                                    top: '1rem',
                                    right: '1rem',
                                    backgroundColor: '#10b981',
                                    color: 'white',
                                    borderRadius: '50%',
                                    width: '24px',
                                    height: '24px',
                                    display: 'flex',
                                    alignItems: 'center',
                                    justifyContent: 'center',
                                    fontSize: '0.75rem'
                                }
                            }, 'âœ“'),

                            h('div', { style: { display: 'flex', alignItems: 'center', gap: '0.75rem', marginBottom: '1rem' } },
                                h('div', { style: { fontSize: '2rem' } }, module.icon),
                                h('div', null,
                                    h('h4', { style: { fontSize: '1.125rem', fontWeight: '600', marginBottom: '0.25rem' } }, 
                                        module.title
                                    ),
                                    h('div', { style: { display: 'flex', gap: '0.5rem', fontSize: '0.75rem', color: '#6b7280' } },
                                        h('span', null, module.duration),
                                        h('span', null, 'â€¢'),
                                        h('span', null, module.difficulty)
                                    )
                                )
                            ),
                            
                            h('p', { style: { color: '#6b7280', fontSize: '0.875rem', marginBottom: '1rem', lineHeight: '1.5' } }, 
                                module.description
                            ),
                            
                            h('div', { style: { display: 'flex', justifyContent: 'space-between', alignItems: 'center' } },
                                h('span', { 
                                    style: { 
                                        fontSize: '0.75rem', 
                                        color: module.completed ? '#059669' : '#6b7280',
                                        fontWeight: module.completed ? '600' : '400'
                                    } 
                                }, 
                                    module.completed ? 'Completed âœ“' : 'Not Started'
                                ),
                                h('button', {
                                    style: {
                                        padding: '0.5rem 1rem',
                                        backgroundColor: module.completed ? '#059669' : '#3b82f6',
                                        color: 'white',
                                        borderRadius: '0.375rem',
                                        border: 'none',
                                        fontSize: '0.875rem',
                                        fontWeight: '500',
                                        cursor: 'pointer'
                                    }
                                }, module.completed ? 'Review' : 'Start')
                            )
                        )
                    )
                )
            ),

            // Coming Soon Section
            h('div', { style: { marginTop: '3rem', padding: '2rem', backgroundColor: '#f8fafc', borderRadius: '0.75rem', border: '2px dashed #e2e8f0' } },
                h('h3', { style: { fontSize: '1.25rem', fontWeight: 'bold', marginBottom: '0.5rem', color: '#64748b' } }, 
                    'ðŸš€ Coming Soon'
                ),
                h('p', { style: { color: '#64748b', marginBottom: '1rem' } }, 
                    'Advanced modules will be unlocked as you complete the foundation'
                ),
                h('div', { style: { display: 'grid', gridTemplateColumns: 'repeat(auto-fit, minmax(200px, 1fr))', gap: '1rem' } },
                    [
                        { title: 'Genus-Specific Modules', icon: 'ðŸ§¬' },
                        { title: 'Advanced Techniques', icon: 'ðŸ”¬' },
                        { title: 'Regional Specialties', icon: 'ðŸ”ï¸' },
                        { title: 'Chemical Testing', icon: 'âš—ï¸' }
                    ].map((item, idx) =>
                        h('div', {
                            key: idx,
                            style: {
                                padding: '1rem',
                                backgroundColor: 'white',
                                borderRadius: '0.5rem',
                                textAlign: 'center',
                                opacity: 0.7
                            }
                        },
                            h('div', { style: { fontSize: '1.5rem', marginBottom: '0.5rem' } }, item.icon),
                            h('p', { style: { fontSize: '0.875rem', color: '#64748b' } }, item.title)
                        )
                    )
                )
            )
        )
    );
};

console.log('âœ… TrainingModules component loaded');